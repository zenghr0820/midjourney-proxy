"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{68656:function(ae,A,a){a.r(A),a.d(A,{default:function(){return c}});var O=a(97857),y=a.n(O),P=a(15009),S=a.n(P),j=a(99289),C=a.n(j),b=a(5574),n=a.n(b),R=a(27986),e=a(78338),Z=a(66927),F=a(94272),B=function(){var h=(0,F.useIntl)();return[{label:h.formatMessage({id:"pages.task.type.IMAGINE"}),value:"IMAGINE"},{label:h.formatMessage({id:"pages.task.type.UPSCALE"}),value:"UPSCALE"},{label:h.formatMessage({id:"pages.task.type.VARIATION"}),value:"VARIATION"},{label:h.formatMessage({id:"pages.task.type.INPAINT"}),value:"INPAINT"},{label:h.formatMessage({id:"pages.task.type.ZOOM"}),value:"ZOOM"},{label:h.formatMessage({id:"pages.task.type.PAN"}),value:"PAN"},{label:h.formatMessage({id:"pages.task.type.DESCRIBE"}),value:"DESCRIBE"},{label:h.formatMessage({id:"pages.task.type.BLEND"}),value:"BLEND"},{label:h.formatMessage({id:"pages.task.type.SHORTEN"}),value:"SHORTEN"},{label:h.formatMessage({id:"pages.task.type.SWAP_FACE"}),value:"SWAP_FACE"},{label:h.formatMessage({id:"pages.task.type.SWAP_VIDEO_FACE"}),value:"SWAP_VIDEO_FACE"}]},l=function(h){var N=useIntl();return N.formatMessage({id:"pages.task.type.".concat(h)})},d=a(82061),W=a(90930),V=a(83231),G=a(53025),M=a(16568),D=a(74330),U=a(58073),w=a(66309),z=a(38703),T=a(86738),r=a(83622),I=a(4393),s=a(67294),t=a(85893),g=function(){var h=(0,s.useState)(!1),N=n()(h,2),k=N[0],X=N[1],K=(0,s.useState)({}),Y=n()(K,2),te=Y[0],E=Y[1],se=(0,s.useState)(""),Q=n()(se,2),L=Q[0],ne=Q[1],re=(0,s.useState)({}),q=n()(re,2),ie=q[0],_=q[1],H=(0,s.useState)(1e3),oe=n()(H,2),ve=oe[0],he=oe[1],Ie=G.Z.useForm(),Me=n()(Ie,1),xe=Me[0],f=(0,F.useIntl)(),de=(0,F.useAccess)(),je=sessionStorage.getItem("mj-image-prefix")||"",ye=M.ZP.useNotification(),ce=n()(ye,2),ge=ce[0],Ee=ce[1],ue=(0,s.useRef)(),Se=function(){E({}),_({}),X(!1)},Ce=function(o,i,u,p){xe.resetFields(),ne(o),E(i),_(u),he(p),X(!0)},Te=function(){var m=C()(S()().mark(function o(i){var u,p;return S()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,(0,Z._5)(i);case 3:u=x.sent,u.success?(ge.success({message:"success",description:f.formatMessage({id:"pages.task.deleteSuccess"})}),(p=ue.current)===null||p===void 0||p.reload()):ge.error({message:"error",description:u.message}),x.next=10;break;case 7:x.prev=7,x.t0=x.catch(0),console.error(x.t0);case 10:return x.prev=10,x.finish(10);case 12:case"end":return x.stop()}},o,null,[[0,7,10,12]])}));return function(i){return m.apply(this,arguments)}}(),Oe=(0,s.useState)(!0),fe=n()(Oe,2),le=fe[0],Ze=fe[1],me=function(){Ze(!1)},Re=function(o){return o&&(0,t.jsx)("video",{width:"200",controls:!0,src:je+o,placeholder:(0,t.jsx)(D.Z,{tip:"Loading",size:"large"})})},Ae=B(),Pe=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(o,i){return(0,t.jsx)("a",{onClick:function(){return Ce(f.formatMessage({id:"pages.task.info"}),(0,t.jsx)(e.Z,{record:i}),null,1100)},children:o})}},{title:f.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",valueEnum:Ae.reduce(function(m,o){return m[o.value]=o.label,m},{}),render:function(o,i){return i.action?f.formatMessage({id:"pages.task.type.".concat(i.action)}):i.displays.action}},{title:f.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(o,i,u){return i.action==="SWAP_VIDEO_FACE"?i.thumbnailUrl&&(0,t.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:i.thumbnailUrl,preview:!1,onClick:function(){window.open(i.imageUrl)},loading:"lazy",onLoad:me,placeholder:(0,t.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(D.Z,{spinning:le})})},u):(i.thumbnailUrl||i.imageUrl)&&(0,t.jsx)(U.Z.PreviewGroup,{items:i.images||[],children:(0,t.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:i.thumbnailUrl||i.imageUrl,preview:{src:i.imageUrl,mask:(0,t.jsx)(D.Z,{spinning:le})},loading:"lazy",onLoad:me,placeholder:(0,t.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(D.Z,{spinning:le})})},u)})}},{title:f.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var m=C()(S()().mark(function i(){return S()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",[{label:f.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:f.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:f.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:f.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:f.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:f.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:f.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return p.stop()}},i)}));function o(){return m.apply(this,arguments)}return o}(),render:function(o,i){var u="default";return o=="NOT_START"?u="default":o=="SUBMITTED"?u="lime":o=="MODAL"?u="warning":o=="IN_PROGRESS"?u="processing":o=="FAILURE"?u="error":o=="SUCCESS"?u="success":o=="CANCEL"&&(u="magenta"),(0,t.jsx)(w.Z,{color:u,children:i.displays.status})}},{title:f.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(o,i){var u=0;o&&o.indexOf("%")>0&&(u=parseInt(o.substring(0,o.indexOf("%"))));var p="normal";return i.status=="SUCCESS"?p="success":i.status=="FAILURE"&&(p="exception"),(0,t.jsx)(z.Z,{percent:u,status:p,size:"small"})}},{title:f.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:f.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:f.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(o,i){return i.properties.discordInstanceId}},{title:f.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(o,i){return i.displays.submitTime}}],be={title:f.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(o,i){if(de.canAdmin)return(0,t.jsx)(T.Z,{title:f.formatMessage({id:"pages.task.delete"}),description:f.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Te(i.id)},children:(0,t.jsx)(r.ZP,{danger:!0,icon:(0,t.jsx)(d.Z,{})})})}},pe=[].concat(Pe);return de.canAdmin&&pe.push(be),(0,t.jsxs)(W._z,{children:[Ee,(0,t.jsx)(I.Z,{children:(0,t.jsx)(V.Z,{columns:pe,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:ue,request:function(){var m=C()(S()().mark(function o(i){var u,p,ee;return S()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,Z.Pn)(y()(y()({},i),{},{pageNumber:i.current-1}));case 2:return u=$.sent,p=u.list.map(function(J){return J.imageUrl||""}).filter(function(J){return J!=""}),ee=u.list,ee.forEach(function(J,De){J.images=p}),$.abrupt("return",{data:ee,total:u.pagination.total,success:!0});case 7:case"end":return $.stop()}},o)}));return function(o){return m.apply(this,arguments)}}()})}),(0,t.jsx)(R.Z,{title:L,modalVisible:k,hideModal:Se,modalContent:te,footer:ie,modalWidth:ve})]})},c=g},78338:function(ae,A,a){var O=a(94272),y=a(66309),P=a(38703),S=a(83062),j=a(58073),C=a(74330),b=a(4393),n=a(26412),R=a(86250),e=a(85893),Z=function(B){var l=B.record,d=(0,O.useIntl)(),W=sessionStorage.getItem("mj-image-prefix")||"",V=function(r){var I="default";return r=="NOT_START"?I="default":r=="SUBMITTED"?I="lime":r=="MODAL"?I="warning":r=="IN_PROGRESS"?I="processing":r=="FAILURE"?I="error":r=="SUCCESS"?I="success":r=="CANCEL"&&(I="magenta"),(0,e.jsx)(y.Z,{color:I,children:l.displays.status})},G=function(r){var I=0;r&&r.indexOf("%")>0&&(I=parseInt(r.substring(0,r.indexOf("%"))));var s="normal";return l.status=="SUCCESS"?s="success":l.status=="FAILURE"&&(s="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(P.Z,{percent:I,status:s})})},M=function(r){return!r||r.length<30?r:(0,e.jsx)(S.Z,{title:r,children:r.substring(0,30)+"..."})},D=function(r){return r&&(0,e.jsx)(j.Z,{width:200,src:W+r,placeholder:(0,e.jsx)(C.Z,{tip:"Loading",size:"large"})})},U=function(r){return r&&(0,e.jsx)("video",{width:"200",controls:!0,src:W+r,placeholder:(0,e.jsx)(C.Z,{tip:"Loading",size:"large"})})},w=function(r){return r=="NIJI_JOURNEY"?(0,e.jsx)(y.Z,{color:"green",children:"niji\u30FBjourney"}):r=="INSIGHT_FACE"||r=="FACE_SWAP"||r=="FACE_SWAP_VIDEO"?(0,e.jsx)(y.Z,{color:"volcano",children:"InsightFace"}):r=="MID_JOURNEY"?(0,e.jsx)(y.Z,{color:"blue",children:"Midjourney"}):"-"},z=function(r){if(!(r==null||!r))return(0,e.jsx)(y.Z,{color:"green",children:d.formatMessage({id:"pages.yes"})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z,{type:"inner",title:d.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:"ID",children:l.id}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.type"}),children:l.action?d.formatMessage({id:"pages.task.type.".concat(l.action)}):l.displays.action}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.status"}),children:V(l.status)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.progress"}),children:G(l.progress)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.prompt"}),children:M(l.prompt)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.promptEn"}),children:M(l.promptEn)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.description"}),children:M(l.description)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.submitTime"}),children:l.displays.submitTime}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.startTime"}),children:l.displays.startTime}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.finishTime"}),children:l.displays.finishTime}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.failReason"}),children:M(l.failReason)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.state"}),children:M(l.state)}),l.action==="SWAP_VIDEO_FACE"?(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.video"}),children:(0,e.jsx)(R.Z,{vertical:!0,children:U(l.imageUrl)})}):(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.image"}),children:D(l.imageUrl)})]})}),(0,e.jsx)(b.Z,{type:"inner",title:d.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.botType"}),children:w(l.botType)}),(0,e.jsx)(n.Z.Item,{label:"Nonce",children:l.nonce}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.account.channelId"}),children:l.properties.discordChannelId}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.instanceId"}),children:l.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:"Hash",children:l.properties.messageHash}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.messageContent"}),children:M(l.properties.messageContent)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.finalPrompt"}),children:M(l.properties.finalPrompt)}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.finalPromptZh"}),children:M(l.promptCn||"-")}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.actionId"}),children:M(l.properties.custom_id||"-")}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.modalConfirm"}),children:z(l.properties.needModel)||"-"}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.imageSeed"}),children:l.seed||"-"}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.notifyHook"}),children:M(l.properties.notifyHook||"-")}),(0,e.jsx)(n.Z.Item,{label:d.formatMessage({id:"pages.task.ip"}),children:l.clientIp||"-"})]})})]})};A.Z=Z},27986:function(ae,A,a){var O=a(28248),y=a(85893),P=function(j){var C=j.title,b=j.modalVisible,n=j.hideModal,R=j.modalContent,e=j.footer,Z=j.modalWidth;return(0,y.jsx)(O.Z,{title:C,open:b,onCancel:n,footer:e,width:Z,children:R})};A.Z=P},86250:function(ae,A,a){a.d(A,{Z:function(){return I}});var O=a(67294),y=a(93967),P=a.n(y),S=a(98423),j=a(98065),C=a(53124),b=a(83559),n=a(83262);const R=["wrap","nowrap","wrap-reverse"],e=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],Z=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],F=(s,t)=>{const g=t.wrap===!0?"wrap":t.wrap;return{[`${s}-wrap-${g}`]:g&&R.includes(g)}},B=(s,t)=>{const g={};return Z.forEach(c=>{g[`${s}-align-${c}`]=t.align===c}),g[`${s}-align-stretch`]=!t.align&&!!t.vertical,g},l=(s,t)=>{const g={};return e.forEach(c=>{g[`${s}-justify-${c}`]=t.justify===c}),g};function d(s,t){return P()(Object.assign(Object.assign(Object.assign({},F(s,t)),B(s,t)),l(s,t)))}var W=d;const V=s=>{const{componentCls:t}=s;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},G=s=>{const{componentCls:t}=s;return{[t]:{"&-gap-small":{gap:s.flexGapSM},"&-gap-middle":{gap:s.flexGap},"&-gap-large":{gap:s.flexGapLG}}}},M=s=>{const{componentCls:t}=s,g={};return R.forEach(c=>{g[`${t}-wrap-${c}`]={flexWrap:c}}),g},D=s=>{const{componentCls:t}=s,g={};return Z.forEach(c=>{g[`${t}-align-${c}`]={alignItems:c}}),g},U=s=>{const{componentCls:t}=s,g={};return e.forEach(c=>{g[`${t}-justify-${c}`]={justifyContent:c}}),g},w=()=>({});var z=(0,b.I$)("Flex",s=>{const{paddingXS:t,padding:g,paddingLG:c}=s,v=(0,n.IX)(s,{flexGapSM:t,flexGap:g,flexGapLG:c});return[V(v),G(v),M(v),D(v),U(v)]},w,{resetStyle:!1}),T=function(s,t){var g={};for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&t.indexOf(c)<0&&(g[c]=s[c]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,c=Object.getOwnPropertySymbols(s);v<c.length;v++)t.indexOf(c[v])<0&&Object.prototype.propertyIsEnumerable.call(s,c[v])&&(g[c[v]]=s[c[v]]);return g},I=O.forwardRef((s,t)=>{const{prefixCls:g,rootClassName:c,className:v,style:h,flex:N,gap:k,children:X,vertical:K=!1,component:Y="div"}=s,te=T(s,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:E,direction:se,getPrefixCls:Q}=O.useContext(C.E_),L=Q("flex",g),[ne,re,q]=z(L),ie=K!=null?K:E==null?void 0:E.vertical,_=P()(v,c,E==null?void 0:E.className,L,re,q,W(L,s),{[`${L}-rtl`]:se==="rtl",[`${L}-gap-${k}`]:(0,j.n)(k),[`${L}-vertical`]:ie}),H=Object.assign(Object.assign({},E==null?void 0:E.style),h);return N&&(H.flex=N),k&&!(0,j.n)(k)&&(H.gap=k),ne(O.createElement(Y,Object.assign({ref:t,className:_,style:H},(0,S.Z)(te,["justify","wrap","align"])),X))})}}]);
