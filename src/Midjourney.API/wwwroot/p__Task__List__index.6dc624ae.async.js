"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{9775:function(q,S,t){t.r(S);var P=t(97857),j=t.n(P),T=t(15009),v=t.n(T),I=t(99289),C=t.n(I),b=t(5574),n=t.n(b),A=t(27986),e=t(78338),y=t(66927),B=t(94272),K=t(82061),i=t(90930),u=t(83231),Z=t(53025),F=t(16568),R=t(74330),E=t(58073),N=t(66309),w=t(38703),$=t(86738),k=t(83622),O=t(4393),a=t(67294),l=t(85893),s=function(){var m=(0,a.useState)(!1),d=n()(m,2),h=d[0],z=d[1],H=(0,a.useState)({}),U=n()(H,2),ee=U[0],L=U[1],te=(0,a.useState)(""),J=n()(te,2),x=J[0],ae=J[1],se=(0,a.useState)({}),D=n()(se,2),ne=D[0],X=D[1],re=(0,a.useState)(1e3),Y=n()(re,2),ie=Y[0],V=Y[1],fe=Z.Z.useForm(),pe=n()(fe,1),Ee=pe[0],f=(0,B.useIntl)(),oe=(0,B.useAccess)(),he=sessionStorage.getItem("mj-image-prefix")||"",Me=F.ZP.useNotification(),de=n()(Me,2),ue=de[0],ve=de[1],ce=(0,a.useRef)(),Ie=function(){L({}),X({}),z(!1)},je=function(o,r,g,_){Ee.resetFields(),ae(o),L(r),X(g),V(_),z(!0)},Ce=function(){var p=C()(v()().mark(function o(r){var g,_;return v()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,M.next=3,(0,y._5)(r);case 3:g=M.sent,g.success?(ue.success({message:"success",description:f.formatMessage({id:"pages.task.deleteSuccess"})}),(_=ce.current)===null||_===void 0||_.reload()):ue.error({message:"error",description:g.message}),M.next=10;break;case 7:M.prev=7,M.t0=M.catch(0),console.error(M.t0);case 10:return M.prev=10,M.finish(10);case 12:case"end":return M.stop()}},o,null,[[0,7,10,12]])}));return function(r){return p.apply(this,arguments)}}(),xe=(0,a.useState)(!0),me=n()(xe,2),le=me[0],Oe=me[1],ge=function(){Oe(!1)},De=function(o){return o&&(0,l.jsx)("video",{width:"200",controls:!0,src:he+o,placeholder:(0,l.jsx)(R.Z,{tip:"Loading",size:"large"})})},Pe=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(o,r){return(0,l.jsx)("a",{onClick:function(){return je(f.formatMessage({id:"pages.task.info"}),(0,l.jsx)(e.Z,{record:r}),null,1100)},children:o})}},{title:f.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var p=C()(v()().mark(function r(){return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"},{label:"SwapVideoFace",value:"SWAP_VIDEO_FACE"}]);case 1:case"end":return _.stop()}},r)}));function o(){return p.apply(this,arguments)}return o}(),render:function(o,r){return r.displays.action}},{title:f.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(o,r,g){return r.action==="SWAP_VIDEO_FACE"?r.thumbnailUrl&&(0,l.jsx)(E.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:r.thumbnailUrl,preview:!1,onClick:function(){window.open(r.imageUrl)},loading:"lazy",onLoad:ge,placeholder:(0,l.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(R.Z,{spinning:le})})},g):(r.thumbnailUrl||r.imageUrl)&&(0,l.jsx)(E.Z.PreviewGroup,{items:r.images||[],children:(0,l.jsx)(E.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:r.thumbnailUrl||r.imageUrl,preview:{src:r.imageUrl,mask:(0,l.jsx)(R.Z,{spinning:le})},loading:"lazy",onLoad:ge,placeholder:(0,l.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(R.Z,{spinning:le})})},g)})}},{title:f.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var p=C()(v()().mark(function r(){return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",[{label:f.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:f.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:f.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:f.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:f.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:f.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:f.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return _.stop()}},r)}));function o(){return p.apply(this,arguments)}return o}(),render:function(o,r){var g="default";return o=="NOT_START"?g="default":o=="SUBMITTED"?g="lime":o=="MODAL"?g="warning":o=="IN_PROGRESS"?g="processing":o=="FAILURE"?g="error":o=="SUCCESS"?g="success":o=="CANCEL"&&(g="magenta"),(0,l.jsx)(N.Z,{color:g,children:r.displays.status})}},{title:f.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(o,r){var g=0;o&&o.indexOf("%")>0&&(g=parseInt(o.substring(0,o.indexOf("%"))));var _="normal";return r.status=="SUCCESS"?_="success":r.status=="FAILURE"&&(_="exception"),(0,l.jsx)(w.Z,{percent:g,status:_,size:"small"})}},{title:f.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:f.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:f.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(o,r){return r.properties.discordInstanceId}},{title:f.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(o,r){return r.displays.submitTime}}],ye={title:f.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(o,r){if(oe.canAdmin)return(0,l.jsx)($.Z,{title:f.formatMessage({id:"pages.task.delete"}),description:f.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Ce(r.id)},children:(0,l.jsx)(k.ZP,{danger:!0,icon:(0,l.jsx)(K.Z,{})})})}},_e=[].concat(Pe);return oe.canAdmin&&_e.push(ye),(0,l.jsxs)(i._z,{children:[ve,(0,l.jsx)(O.Z,{children:(0,l.jsx)(u.Z,{columns:_e,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:ce,request:function(){var p=C()(v()().mark(function o(r){var g,_,Q;return v()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,y.Pn)(j()(j()({},r),{},{pageNumber:r.current-1}));case 2:return g=W.sent,_=g.list.map(function(G){return G.imageUrl||""}).filter(function(G){return G!=""}),Q=g.list,Q.forEach(function(G,Se){G.images=_}),W.abrupt("return",{data:Q,total:g.pagination.total,success:!0});case 7:case"end":return W.stop()}},o)}));return function(o){return p.apply(this,arguments)}}()})}),(0,l.jsx)(A.Z,{title:x,modalVisible:h,hideModal:Ie,modalContent:ee,footer:ne,modalWidth:ie})]})};S.default=s},78338:function(q,S,t){var P=t(94272),j=t(66309),T=t(38703),v=t(83062),I=t(58073),C=t(74330),b=t(4393),n=t(26412),A=t(86250),e=t(85893),y=function(K){var i=K.record,u=(0,P.useIntl)(),Z=sessionStorage.getItem("mj-image-prefix")||"",F=function(a){var l="default";return a=="NOT_START"?l="default":a=="SUBMITTED"?l="lime":a=="MODAL"?l="warning":a=="IN_PROGRESS"?l="processing":a=="FAILURE"?l="error":a=="SUCCESS"?l="success":a=="CANCEL"&&(l="magenta"),(0,e.jsx)(j.Z,{color:l,children:i.displays.status})},R=function(a){var l=0;a&&a.indexOf("%")>0&&(l=parseInt(a.substring(0,a.indexOf("%"))));var s="normal";return i.status=="SUCCESS"?s="success":i.status=="FAILURE"&&(s="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(T.Z,{percent:l,status:s})})},E=function(a){return!a||a.length<30?a:(0,e.jsx)(v.Z,{title:a,children:a.substring(0,30)+"..."})},N=function(a){return a&&(0,e.jsx)(I.Z,{width:200,src:Z+a,placeholder:(0,e.jsx)(C.Z,{tip:"Loading",size:"large"})})},w=function(a){return a&&(0,e.jsx)("video",{width:"200",controls:!0,src:Z+a,placeholder:(0,e.jsx)(C.Z,{tip:"Loading",size:"large"})})},$=function(a){return a=="NIJI_JOURNEY"?(0,e.jsx)(j.Z,{color:"green",children:"niji\u30FBjourney"}):a=="INSIGHT_FACE"||a=="FACE_SWAP"||a=="FACE_SWAP_VIDEO"?(0,e.jsx)(j.Z,{color:"volcano",children:"InsightFace"}):a=="MID_JOURNEY"?(0,e.jsx)(j.Z,{color:"blue",children:"Midjourney"}):"-"},k=function(a){if(!(a==null||!a))return(0,e.jsx)(j.Z,{color:"green",children:u.formatMessage({id:"pages.yes"})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z,{type:"inner",title:u.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:"ID",children:i.id}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.type"}),children:i.displays.action}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.status"}),children:F(i.status)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.progress"}),children:R(i.progress)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.prompt"}),children:E(i.prompt)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.promptEn"}),children:E(i.promptEn)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.description"}),children:E(i.description)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.submitTime"}),children:i.displays.submitTime}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.startTime"}),children:i.displays.startTime}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.finishTime"}),children:i.displays.finishTime}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.failReason"}),children:E(i.failReason)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.state"}),children:E(i.state)}),i.action==="SWAP_VIDEO_FACE"?(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.video"}),children:(0,e.jsx)(A.Z,{vertical:!0,children:w(i.imageUrl)})}):(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.image"}),children:N(i.imageUrl)})]})}),(0,e.jsx)(b.Z,{type:"inner",title:u.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.botType"}),children:$(i.botType)}),(0,e.jsx)(n.Z.Item,{label:"Nonce",children:i.nonce}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.account.channelId"}),children:i.properties.discordChannelId}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.instanceId"}),children:i.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:"Hash",children:i.properties.messageHash}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.messageContent"}),children:E(i.properties.messageContent)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.finalPrompt"}),children:E(i.properties.finalPrompt)}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.finalPromptZh"}),children:E(i.promptCn||"-")}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.actionId"}),children:E(i.properties.custom_id||"-")}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.modalConfirm"}),children:k(i.properties.needModel)||"-"}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.imageSeed"}),children:i.seed||"-"}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.notifyHook"}),children:E(i.properties.notifyHook||"-")}),(0,e.jsx)(n.Z.Item,{label:u.formatMessage({id:"pages.task.ip"}),children:i.clientIp||"-"})]})})]})};S.Z=y},27986:function(q,S,t){var P=t(28248),j=t(85893),T=function(I){var C=I.title,b=I.modalVisible,n=I.hideModal,A=I.modalContent,e=I.footer,y=I.modalWidth;return(0,j.jsx)(P.Z,{title:C,open:b,onCancel:n,footer:e,width:y,children:A})};S.Z=T},86250:function(q,S,t){t.d(S,{Z:function(){return l}});var P=t(67294),j=t(93967),T=t.n(j),v=t(98423),I=t(98065),C=t(53124),b=t(83559),n=t(83262);const A=["wrap","nowrap","wrap-reverse"],e=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],y=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],B=(s,c)=>{const m=c.wrap===!0?"wrap":c.wrap;return{[`${s}-wrap-${m}`]:m&&A.includes(m)}},K=(s,c)=>{const m={};return y.forEach(d=>{m[`${s}-align-${d}`]=c.align===d}),m[`${s}-align-stretch`]=!c.align&&!!c.vertical,m},i=(s,c)=>{const m={};return e.forEach(d=>{m[`${s}-justify-${d}`]=c.justify===d}),m};function u(s,c){return T()(Object.assign(Object.assign(Object.assign({},B(s,c)),K(s,c)),i(s,c)))}var Z=u;const F=s=>{const{componentCls:c}=s;return{[c]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},R=s=>{const{componentCls:c}=s;return{[c]:{"&-gap-small":{gap:s.flexGapSM},"&-gap-middle":{gap:s.flexGap},"&-gap-large":{gap:s.flexGapLG}}}},E=s=>{const{componentCls:c}=s,m={};return A.forEach(d=>{m[`${c}-wrap-${d}`]={flexWrap:d}}),m},N=s=>{const{componentCls:c}=s,m={};return y.forEach(d=>{m[`${c}-align-${d}`]={alignItems:d}}),m},w=s=>{const{componentCls:c}=s,m={};return e.forEach(d=>{m[`${c}-justify-${d}`]={justifyContent:d}}),m},$=()=>({});var k=(0,b.I$)("Flex",s=>{const{paddingXS:c,padding:m,paddingLG:d}=s,h=(0,n.IX)(s,{flexGapSM:c,flexGap:m,flexGapLG:d});return[F(h),R(h),E(h),N(h),w(h)]},$,{resetStyle:!1}),O=function(s,c){var m={};for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&c.indexOf(d)<0&&(m[d]=s[d]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,d=Object.getOwnPropertySymbols(s);h<d.length;h++)c.indexOf(d[h])<0&&Object.prototype.propertyIsEnumerable.call(s,d[h])&&(m[d[h]]=s[d[h]]);return m},l=P.forwardRef((s,c)=>{const{prefixCls:m,rootClassName:d,className:h,style:z,flex:H,gap:U,children:ee,vertical:L=!1,component:te="div"}=s,J=O(s,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:x,direction:ae,getPrefixCls:se}=P.useContext(C.E_),D=se("flex",m),[ne,X,re]=k(D),Y=L!=null?L:x==null?void 0:x.vertical,ie=T()(h,d,x==null?void 0:x.className,D,X,re,Z(D,s),{[`${D}-rtl`]:ae==="rtl",[`${D}-gap-${U}`]:(0,I.n)(U),[`${D}-vertical`]:Y}),V=Object.assign(Object.assign({},x==null?void 0:x.style),z);return H&&(V.flex=H),U&&!(0,I.n)(U)&&(V.gap=U),ne(P.createElement(te,Object.assign({ref:c,className:ie,style:V},(0,v.Z)(J,["justify","wrap","align"])),ee))})}}]);
