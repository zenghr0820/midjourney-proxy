"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{12154:function(ie,U,t){t.r(U),t.d(U,{default:function(){return ne}});var F=t(97857),N=t.n(F),L=t(15009),y=t.n(L),C=t(99289),O=t.n(C),G=t(5574),S=t.n(G),k=t(27986),A=t(94272),M=t(66309),J=t(38703),Q=t(83062),D=t(58073),R=t(74330),W=t(4393),d=t(26412),q=t(86250),e=t(85893),_=function(b){var i=b.record,o=(0,A.useIntl)(),P=sessionStorage.getItem("mj-image-prefix")||"",B=function(s){var v="default";return s=="NOT_START"?v="default":s=="SUBMITTED"?v="lime":s=="MODAL"?v="warning":s=="IN_PROGRESS"?v="processing":s=="FAILURE"?v="error":s=="SUCCESS"?v="success":s=="CANCEL"&&(v="magenta"),(0,e.jsx)(M.Z,{color:v,children:i.displays.status})},x=function(s){var v=0;s&&s.indexOf("%")>0&&(v=parseInt(s.substring(0,s.indexOf("%"))));var T="normal";return i.status=="SUCCESS"?T="success":i.status=="FAILURE"&&(T="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(J.Z,{percent:v,status:T})})},I=function(s){return!s||s.length<30?s:(0,e.jsx)(Q.Z,{title:s,children:s.substring(0,30)+"..."})},$=function(s){return s&&(0,e.jsx)(D.Z,{width:200,src:P+s,placeholder:(0,e.jsx)(R.Z,{tip:"Loading",size:"large"})})},Z=function(s){return s&&(0,e.jsx)("video",{width:"200",controls:!0,src:P+s,placeholder:(0,e.jsx)(R.Z,{tip:"Loading",size:"large"})})},w=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(M.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"||s=="FACE_SWAP"||s=="FACE_SWAP_VIDEO"?(0,e.jsx)(M.Z,{color:"volcano",children:"InsightFace"}):s=="MID_JOURNEY"?(0,e.jsx)(M.Z,{color:"blue",children:"Midjourney"}):"-"},z=function(s){if(!(s==null||!s))return(0,e.jsx)(M.Z,{color:"green",children:o.formatMessage({id:"pages.yes"})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(W.Z,{type:"inner",title:o.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(d.Z,{column:2,children:[(0,e.jsx)(d.Z.Item,{label:"ID",children:i.id}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.type"}),children:i.displays.action}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.status"}),children:B(i.status)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.progress"}),children:x(i.progress)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.prompt"}),children:I(i.prompt)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.promptEn"}),children:I(i.promptEn)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.description"}),children:I(i.description)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.submitTime"}),children:i.displays.submitTime}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.startTime"}),children:i.displays.startTime}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.finishTime"}),children:i.displays.finishTime}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.failReason"}),children:I(i.failReason)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.state"}),children:I(i.state)}),i.action==="SWAP_VIDEO_FACE"?(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.video"}),children:(0,e.jsx)(q.Z,{vertical:!0,children:Z(i.imageUrl)})}):(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.image"}),children:$(i.imageUrl)})]})}),(0,e.jsx)(W.Z,{type:"inner",title:o.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(d.Z,{column:2,children:[(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.botType"}),children:w(i.botType)}),(0,e.jsx)(d.Z.Item,{label:"Nonce",children:i.nonce}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.account.channelId"}),children:i.properties.discordInstanceId}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.instanceId"}),children:i.properties.discordInstanceId}),(0,e.jsx)(d.Z.Item,{label:"Hash",children:i.properties.messageHash}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.messageContent"}),children:I(i.properties.messageContent)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.finalPrompt"}),children:I(i.properties.finalPrompt)}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.finalPromptZh"}),children:I(i.promptCn||"-")}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.actionId"}),children:I(i.properties.custom_id||"-")}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.modalConfirm"}),children:z(i.properties.needModel)||"-"}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.imageSeed"}),children:i.seed||"-"}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.notifyHook"}),children:I(i.properties.notifyHook||"-")}),(0,e.jsx)(d.Z.Item,{label:o.formatMessage({id:"pages.task.ip"}),children:i.clientIp||"-"})]})})]})},ee=_,X=t(66927),te=t(82061),ae=t(90930),le=t(51967),se=t(53025),a=t(16568),c=t(86738),u=t(83622),n=t(67294),h=function(){var b=(0,n.useState)(!1),i=S()(b,2),o=i[0],P=i[1],B=(0,n.useState)({}),x=S()(B,2),I=x[0],$=x[1],Z=(0,n.useState)(""),w=S()(Z,2),z=w[0],E=w[1],s=(0,n.useState)({}),v=S()(s,2),T=v[0],oe=v[1],ve=(0,n.useState)(1e3),de=S()(ve,2),xe=de[0],Ie=de[1],je=se.Z.useForm(),Se=S()(je,1),ye=Se[0],m=(0,A.useIntl)(),ce=(0,A.useAccess)(),Ce=sessionStorage.getItem("mj-image-prefix")||"",Me=a.ZP.useNotification(),ue=S()(Me,2),ge=ue[0],Ze=ue[1],fe=(0,n.useRef)(),Ee=function(){$({}),oe({}),P(!1)},be=function(l,r,g,f){ye.resetFields(),E(l),$(r),oe(g),Ie(f),P(!0)},Te=function(){var p=O()(y()().mark(function l(r){var g,f;return y()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,(0,X._5)(r);case 3:g=j.sent,g.success?(ge.success({message:"success",description:m.formatMessage({id:"pages.task.deleteSuccess"})}),(f=fe.current)===null||f===void 0||f.reload()):ge.error({message:"error",description:g.message}),j.next=10;break;case 7:j.prev=7,j.t0=j.catch(0),console.error(j.t0);case 10:return j.prev=10,j.finish(10);case 12:case"end":return j.stop()}},l,null,[[0,7,10,12]])}));return function(r){return p.apply(this,arguments)}}(),Oe=(0,n.useState)(!0),me=S()(Oe,2),re=me[0],Ae=me[1],pe=function(){Ae(!1)},Pe=function(l){return l&&(0,e.jsx)("video",{width:"200",controls:!0,src:Ce+l,placeholder:(0,e.jsx)(R.Z,{tip:"Loading",size:"large"})})},Re=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(l,r){return(0,e.jsx)("a",{onClick:function(){return be(m.formatMessage({id:"pages.task.info"}),(0,e.jsx)(ee,{record:r}),null,1100)},children:l})}},{title:m.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var p=O()(y()().mark(function r(){return y()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"},{label:"SwapVideoFace",value:"SWAP_VIDEO_FACE"}]);case 1:case"end":return f.stop()}},r)}));function l(){return p.apply(this,arguments)}return l}(),render:function(l,r){return r.displays.action}},{title:m.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(l,r,g){return r.action==="SWAP_VIDEO_FACE"?r.thumbnailUrl&&(0,e.jsx)(D.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:r.thumbnailUrl,preview:!1,onClick:function(){window.open(r.imageUrl)},loading:"lazy",onLoad:pe,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(R.Z,{spinning:re})})},g):(r.thumbnailUrl||r.imageUrl)&&(0,e.jsx)(D.Z.PreviewGroup,{items:r.images||[],children:(0,e.jsx)(D.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:r.thumbnailUrl||r.imageUrl,preview:{src:r.imageUrl,mask:(0,e.jsx)(R.Z,{spinning:re})},loading:"lazy",onLoad:pe,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(R.Z,{spinning:re})})},g)})}},{title:m.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var p=O()(y()().mark(function r(){return y()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",[{label:m.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:m.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:m.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:m.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:m.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:m.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:m.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return f.stop()}},r)}));function l(){return p.apply(this,arguments)}return l}(),render:function(l,r){var g="default";return l=="NOT_START"?g="default":l=="SUBMITTED"?g="lime":l=="MODAL"?g="warning":l=="IN_PROGRESS"?g="processing":l=="FAILURE"?g="error":l=="SUCCESS"?g="success":l=="CANCEL"&&(g="magenta"),(0,e.jsx)(M.Z,{color:g,children:r.displays.status})}},{title:m.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(l,r){var g=0;l&&l.indexOf("%")>0&&(g=parseInt(l.substring(0,l.indexOf("%"))));var f="normal";return r.status=="SUCCESS"?f="success":r.status=="FAILURE"&&(f="exception"),(0,e.jsx)(J.Z,{percent:g,status:f,size:"small"})}},{title:m.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:m.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:m.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(l,r){return r.properties.discordInstanceId}},{title:m.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(l,r){return r.displays.submitTime}}],Fe={title:m.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(l,r){if(ce.canAdmin)return(0,e.jsx)(c.Z,{title:m.formatMessage({id:"pages.task.delete"}),description:m.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Te(r.id)},children:(0,e.jsx)(u.ZP,{danger:!0,icon:(0,e.jsx)(te.Z,{})})})}},he=[].concat(Re);return ce.canAdmin&&he.push(Fe),(0,e.jsxs)(ae._z,{children:[Ze,(0,e.jsx)(W.Z,{children:(0,e.jsx)(le.Z,{columns:he,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:fe,request:function(){var p=O()(y()().mark(function l(r){var g,f,K;return y()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,X.Pn)(N()(N()({},r),{},{pageNumber:r.current-1}));case 2:return g=V.sent,f=g.list.map(function(H){return H.imageUrl||""}).filter(function(H){return H!=""}),K=g.list,K.forEach(function(H,Ue){H.images=f}),V.abrupt("return",{data:K,total:g.pagination.total,success:!0});case 7:case"end":return V.stop()}},l)}));return function(l){return p.apply(this,arguments)}}()})}),(0,e.jsx)(k.Z,{title:z,modalVisible:o,hideModal:Ee,modalContent:I,footer:T,modalWidth:xe})]})},ne=h},27986:function(ie,U,t){var F=t(28248),N=t(85893),L=function(C){var O=C.title,G=C.modalVisible,S=C.hideModal,k=C.modalContent,A=C.footer,M=C.modalWidth;return(0,N.jsx)(F.Z,{title:O,open:G,onCancel:S,footer:A,width:M,children:k})};U.Z=L},86250:function(ie,U,t){t.d(U,{Z:function(){return se}});var F=t(67294),N=t(93967),L=t.n(N),y=t(98423),C=t(98065),O=t(53124),G=t(83559),S=t(83262);const k=["wrap","nowrap","wrap-reverse"],A=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],M=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],J=(a,c)=>{const u=c.wrap===!0?"wrap":c.wrap;return{[`${a}-wrap-${u}`]:u&&k.includes(u)}},Q=(a,c)=>{const u={};return M.forEach(n=>{u[`${a}-align-${n}`]=c.align===n}),u[`${a}-align-stretch`]=!c.align&&!!c.vertical,u},D=(a,c)=>{const u={};return A.forEach(n=>{u[`${a}-justify-${n}`]=c.justify===n}),u};function R(a,c){return L()(Object.assign(Object.assign(Object.assign({},J(a,c)),Q(a,c)),D(a,c)))}var W=R;const d=a=>{const{componentCls:c}=a;return{[c]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},q=a=>{const{componentCls:c}=a;return{[c]:{"&-gap-small":{gap:a.flexGapSM},"&-gap-middle":{gap:a.flexGap},"&-gap-large":{gap:a.flexGapLG}}}},e=a=>{const{componentCls:c}=a,u={};return k.forEach(n=>{u[`${c}-wrap-${n}`]={flexWrap:n}}),u},_=a=>{const{componentCls:c}=a,u={};return M.forEach(n=>{u[`${c}-align-${n}`]={alignItems:n}}),u},ee=a=>{const{componentCls:c}=a,u={};return A.forEach(n=>{u[`${c}-justify-${n}`]={justifyContent:n}}),u},X=()=>({});var te=(0,G.I$)("Flex",a=>{const{paddingXS:c,padding:u,paddingLG:n}=a,h=(0,S.IX)(a,{flexGapSM:c,flexGap:u,flexGapLG:n});return[d(h),q(h),e(h),_(h),ee(h)]},X,{resetStyle:!1}),ae=function(a,c){var u={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&c.indexOf(n)<0&&(u[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,n=Object.getOwnPropertySymbols(a);h<n.length;h++)c.indexOf(n[h])<0&&Object.prototype.propertyIsEnumerable.call(a,n[h])&&(u[n[h]]=a[n[h]]);return u},se=F.forwardRef((a,c)=>{const{prefixCls:u,rootClassName:n,className:h,style:ne,flex:Y,gap:b,children:i,vertical:o=!1,component:P="div"}=a,B=ae(a,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:x,direction:I,getPrefixCls:$}=F.useContext(O.E_),Z=$("flex",u),[w,z,E]=te(Z),s=o!=null?o:x==null?void 0:x.vertical,v=L()(h,n,x==null?void 0:x.className,Z,z,E,W(Z,a),{[`${Z}-rtl`]:I==="rtl",[`${Z}-gap-${b}`]:(0,C.n)(b),[`${Z}-vertical`]:s}),T=Object.assign(Object.assign({},x==null?void 0:x.style),ne);return Y&&(T.flex=Y),b&&!(0,C.n)(b)&&(T.gap=b),w(F.createElement(P,Object.assign({ref:c,className:v,style:T},(0,y.Z)(B,["justify","wrap","align"])),i))})}}]);
